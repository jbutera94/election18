---
layout: main
title: Search Articles
extraCSS:
- articleList
---
<h2>Search all articles</h2>
<style>
    .search-controls {
        margin-bottom: 30px;
        padding: 15px;
    }
    .search-controls .search-box {
        margin-right: 4px;
    }
    form[name="sort"] {
        float: right;
        padding: 5px;
    }
</style>
<div class="search-controls card">
    <input type="text" id="query" class="search-box" placeholder="Search Articles..."/><button id="search" class="search-button">Search</button> - <span id="resultcount">0</span> results
    <form name="sort">
        Sort:
        <label for="sort-recent"><input type="radio" name="sort" id="sort-recent" value="recent" checked>Recent</label>
        <label for="sort-old"><input type="radio" name="sort" id="sort-old" value="old">Old</label>
        <label for="sort-title"><input type="radio" name="sort" id="sort-title" value="title">Title</label>
        <label for="sort-author"><input type="radio" name="sort" id="sort-author" value="author">Author</label>
    </form>
</div>
<div class="article-list-sortable">
    {% for post in site.posts %}
        <div class="list-article card" style="order: {{ forloop.index }};">
            <a href="{{ site.baseurl }}{{ post.url }}" class="list-article-cover">
                <img class="img-card" src="{{ site.baseurl }}/assets{{ post.id }}/cover.jpg"></img>
            </a>
            <div class="list-article-text">
                <a class="list-article-title" href="{{ site.baseurl }}{{ post.url }}">
                    {{ post.title }}
                </a>
                <div class="list-article-date" data-date="{{ post.date }}">
                    Posted on {{ post.date | date_to_long_string: "ordinal", "US" }}
                </div>
                <div class="list-article-authors">
                    By 
                    {% for author in post.authors %}
                        <a href="{{ site.baseurl }}/authors/{{ author | slugify }}.html">{{ author }}</a>{% unless forloop.last %},{% endunless %}
                    {% endfor %}
                </div>
                <div class="list-article-tags">
                    Tags: {% for tag in post.tags %}
                        <a href="{{ site.baseurl }}/tags/{{ tag | slugify }}.html">{{ tag }}</a>{% unless forloop.last %},{% endunless %}
                    {% endfor %}
                </div>
                <div class="list-article-excerpt">
                    {{ post.excerpt }}
                </div>
                <a class="list-article-readmore" href="{{ site.baseurl }}{{ post.url }}">Read more...</a>
            </div>
        </div>
    {% endfor %}
</div>
<div id="notfound">No articles match that search.</div>
<script type="text/javascript">
    let articles = [...document.getElementsByClassName("list-article")];
    let notfound = document.getElementById("notfound");
    let resultcount = document.getElementById("resultcount");
    
    function displayResults(query) {
        let found = 0;
        articles.forEach(article => {
            if (query === ""
            // please don't break this, it is very specific
            ||  article.getElementsByClassName("list-article-title")[0].textContent.toLowerCase().indexOf(query.toLowerCase()) != -1
            ||  article.getElementsByClassName("list-article-authors")[0].textContent.toLowerCase().indexOf(query.toLowerCase()) != -1
            ||  article.getElementsByClassName("list-article-tags")[0].textContent.toLowerCase().substr(6).indexOf(query.toLowerCase()) != -1
            ||  article.getElementsByClassName("list-article-excerpt")[0].textContent.toLowerCase().indexOf(query.toLowerCase()) != -1) {
                article.style.display = "";
                found++;
            } else {
                article.style.display = "none";
            }
        });
        resultcount.textContent = found;
        if (found) {
            notfound.style.display = "none";
        } else {
            notfound.style.display = "";
        }
    }
    displayResults(window.location.search.substr(7).replace(/\+/g, " "));
    document.getElementById("query").value = window.location.search.substr(7).replace(/\+/g, " ");
    document.getElementById("search").addEventListener('click', e => {
        history.pushState({},"","?query=" + document.getElementById("query").value.replace(/ /g,"+")); /*global history*/
        displayResults(document.getElementById("query").value);
    });
    document.getElementById("query").addEventListener('keydown', e => {
        if (e.key != "Enter" && e.key != "Return") return;
        history.pushState({},"","?query=" + document.getElementById("query").value.replace(/ /g,"+")); /*global history*/
        displayResults(document.getElementById("query").value);
    });
    
    let sortMethod = "load";
    let sortFunctions = {
        recent: (a, b) => {
            let x = b.getElementsByClassName("list-article-date")[0].getAttribute("data-date");
            let y = a.getElementsByClassName("list-article-date")[0].getAttribute("data-date");
            if (x < y) return -1;
            if (x > y) return 1;
            return 0;
        },
        old: (a, b) => {
            let x = a.getElementsByClassName("list-article-date")[0].getAttribute("data-date");
            let y = b.getElementsByClassName("list-article-date")[0].getAttribute("data-date");
            if (x < y) return -1;
            if (x > y) return 1;
            return 0;
        },
        title: (a, b) => {
            let x = a.getElementsByClassName("list-article-title")[0].textContent.toLowerCase();
            let y = b.getElementsByClassName("list-article-title")[0].textContent.toLowerCase();
            if (x < y) return -1;
            if (x > y) return 1;
            return 0;
        },
        author: (a, b) => {
            let x = a.getElementsByClassName("list-article-authors")[0].textContent.toLowerCase();
            let y = b.getElementsByClassName("list-article-authors")[0].textContent.toLowerCase();
            if (x < y) return -1;
            if (x > y) return 1;
            return 0;
        }
    };
    function sort(method) {
        if (method == sortMethod) return;
        sortMethod = method;
        articles.map(a => a).sort(sortFunctions[method]).forEach((article, index) => {
            article.style.order = index;
        });
    }
    sort("recent");
    sortMethod = "recent";
    document.forms.sort.addEventListener('click', e => {
        sort(document.forms.sort.sort.value);
    });
</script>